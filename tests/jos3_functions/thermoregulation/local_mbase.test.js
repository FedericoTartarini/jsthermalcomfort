import { local_mbase } from "../../../src/jos3_functions/thermoregulation/local_mbase";
import { describe, it, expect } from "@jest/globals";

describe("local_mbase", () => {
  it.each([
    {
      bmr_equation: "harris-benedict",
      sex: "male",
      expected: [
        [
          17.1968410354608, 0.28498677793919996, 25.234523679931197,
          22.5852021516816, 8.364010096987199, 1.262209957848, 0.3597518277072,
          0.0932364150048, 1.262209957848, 0.3597518277072, 0.0932364150048,
          1.3695197939855999, 0.37118648237759994, 0.2198972052,
          1.3695197939855999, 0.37118648237759994, 0.2198972052,
        ],
        [
          0.2216563828416, 0, 0, 0, 4.2255446951232, 0, 0, 0, 0, 0, 0, 0, 0, 0,
          0, 0, 0,
        ],
        [
          0.1117077802416, 0, 0, 0, 0.8356093797599999, 0, 0, 0, 0, 0, 0, 0, 0,
          0, 0, 0, 0,
        ],
        [
          0.1336975007616, 0.029026431086399997, 0.18559324118879997,
          0.1644831094896, 0.26387664624, 0.0518957404272, 0.027267253444799997,
          0.0518957404272, 0.0518957404272, 0.027267253444799997,
          0.0518957404272, 0.1266607901952, 0.023748898161599998,
          0.1037914808544, 0.1266607901952, 0.023748898161599998,
          0.1037914808544,
        ],
      ],
    },
    {
      bmr_equation: "harris-benedict_origin",
      sex: "male",
      expected: [
        [
          17.03726243884224, 0.28234223467776004, 25.00035916873536,
          22.37562209821248, 8.28639601713216, 1.2504972430944001,
          0.35641349994816, 0.09237122492544, 1.2504972430944001,
          0.35641349994816, 0.09237122492544, 1.35681129442368,
          0.36774204640128, 0.21785666256000003, 1.35681129442368,
          0.36774204640128, 0.21785666256000003,
        ],
        [
          0.21959951586048004, 0, 0, 0, 4.18633362775296, 0, 0, 0, 0, 0, 0, 0,
          0, 0, 0, 0, 0,
        ],
        [
          0.11067118458048002, 0, 0, 0, 0.827855317728, 0, 0, 0, 0, 0, 0, 0, 0,
          0, 0, 0, 0,
        ],
        [
          0.13245685083648, 0.028757079457920002, 0.18387102320064,
          0.16295678359488, 0.26142799507200004, 0.05141417236416001,
          0.027014226157440004, 0.05141417236416001, 0.05141417236416001,
          0.027014226157440004, 0.05141417236416001, 0.12548543763456002,
          0.023528519556480002, 0.10282834472832002, 0.12548543763456002,
          0.023528519556480002, 0.10282834472832002,
        ],
      ],
    },
    {
      bmr_equation: "japanese",
      sex: "male",
      expected: [
        [
          15.480991078795988, 0.25655163978977547, 22.716697512126135,
          20.331717453339706, 7.529473897410416, 1.1362703799331104,
          0.3238568539321548, 0.08393356116579073, 1.1362703799331104,
          0.3238568539321548, 0.08393356116579073, 1.2328731578786432,
          0.3341505925656952, 0.19795651218346874, 1.2328731578786432,
          0.3341505925656952, 0.19795651218346874,
        ],
        [
          0.1995401642809365, 0, 0, 0, 3.803932338117535, 0, 0, 0, 0, 0, 0, 0,
          0, 0, 0, 0, 0,
        ],
        [
          0.10056190818920212, 0, 0, 0, 0.7522347462971811, 0, 0, 0, 0, 0, 0, 0,
          0, 0, 0, 0, 0,
        ],
        [
          0.120357559407549, 0.02613025960821787, 0.1670752962828476,
          0.1480714711132346, 0.23754781462016247, 0.04671773687529862,
          0.02454660751075012, 0.04671773687529862, 0.04671773687529862,
          0.02454660751075012, 0.04671773687529862, 0.114022951017678,
          0.021379303315814623, 0.09343547375059724, 0.114022951017678,
          0.021379303315814623, 0.09343547375059724,
        ],
      ],
    },
    {
      bmr_equation: "ganpule",
      sex: "male",
      expected: [
        [
          15.480991078795988, 0.25655163978977547, 22.716697512126135,
          20.331717453339706, 7.529473897410416, 1.1362703799331104,
          0.3238568539321548, 0.08393356116579073, 1.1362703799331104,
          0.3238568539321548, 0.08393356116579073, 1.2328731578786432,
          0.3341505925656952, 0.19795651218346874, 1.2328731578786432,
          0.3341505925656952, 0.19795651218346874,
        ],
        [
          0.1995401642809365, 0, 0, 0, 3.803932338117535, 0, 0, 0, 0, 0, 0, 0,
          0, 0, 0, 0, 0,
        ],
        [
          0.10056190818920212, 0, 0, 0, 0.7522347462971811, 0, 0, 0, 0, 0, 0, 0,
          0, 0, 0, 0, 0,
        ],
        [
          0.120357559407549, 0.02613025960821787, 0.1670752962828476,
          0.1480714711132346, 0.23754781462016247, 0.04671773687529862,
          0.02454660751075012, 0.04671773687529862, 0.04671773687529862,
          0.02454660751075012, 0.04671773687529862, 0.114022951017678,
          0.021379303315814623, 0.09343547375059724, 0.114022951017678,
          0.021379303315814623, 0.09343547375059724,
        ],
      ],
    },
    {
      bmr_equation: "harris-benedict",
      sex: "female",
      expected: [
        [
          17.592852014740803, 0.29154948865920005, 25.815627407851203,
          23.105296976241604, 8.5566175545072, 1.2912762846480001,
          0.3680362372272001, 0.09538347468480002, 1.2912762846480001,
          0.3680362372272001, 0.09538347468480002, 1.4010572649456003,
          0.37973421053760004, 0.22496102520000005, 1.4010572649456003,
          0.37973421053760004, 0.22496102520000005,
        ],
        [
          0.22676071340160006, 0, 0, 0, 4.322851060243201, 0, 0, 0, 0, 0, 0, 0,
          0, 0, 0, 0, 0,
        ],
        [
          0.11428020080160003, 0, 0, 0, 0.8548518957600002, 0, 0, 0, 0, 0, 0, 0,
          0, 0, 0, 0, 0,
        ],
        [
          0.13677630332160004, 0.029694855326400007, 0.18986710526880002,
          0.16827084684960003, 0.26995323024000006, 0.05309080194720001,
          0.027895167124800006, 0.05309080194720001, 0.05309080194720001,
          0.027895167124800006, 0.05309080194720001, 0.12957755051520004,
          0.024295790721600007, 0.10618160389440003, 0.12957755051520004,
          0.024295790721600007, 0.10618160389440003,
        ],
      ],
    },
    {
      bmr_equation: "harris-benedict_origin",
      sex: "female",
      expected: [
        [
          14.935574114717763, 0.24751296676224005, 21.916356492104644,
          19.615402615907524, 7.264200002907841, 1.0962379855056001,
          0.31244692409184005, 0.08097646443456001, 1.0962379855056001,
          0.31244692409184005, 0.08097646443456001, 1.1894373124963202,
          0.32237799991872007, 0.19098222744000004, 1.1894373124963202,
          0.32237799991872007, 0.19098222744000004,
        ],
        [
          0.19251008525952004, 0, 0, 0, 3.669914482487041, 0, 0, 0, 0, 0, 0, 0,
          0, 0, 0, 0, 0,
        ],
        [
          0.09701897153952004, 0, 0, 0, 0.7257324642720001, 0, 0, 0, 0, 0, 0, 0,
          0, 0, 0, 0, 0,
        ],
        [
          0.11611719428352003, 0.025209654022080006, 0.16118899995936004,
          0.14285470612512002, 0.22917867292800007, 0.045071805675840015,
          0.023681796202560005, 0.045071805675840015, 0.045071805675840015,
          0.023681796202560005, 0.045071805675840015, 0.11000576300544003,
          0.020626080563520006, 0.09014361135168003, 0.11000576300544003,
          0.020626080563520006, 0.09014361135168003,
        ],
      ],
    },
    {
      bmr_equation: "japanese",
      sex: "female",
      expected: [
        [
          14.254014035317727, 0.23621812426182515, 20.916240021442906,
          18.720286347749642, 6.932710319770664, 1.0462129886287626,
          0.29818892846631634, 0.07728123818442427, 1.0462129886287626,
          0.29818892846631634, 0.07728123818442427, 1.1351593193693266,
          0.30766681616817965, 0.1822670711896799, 1.1351593193693266,
          0.30766681616817965, 0.1822670711896799,
        ],
        [
          0.18372520775919735, 0, 0, 0, 3.502444039980889, 0, 0, 0, 0, 0, 0, 0,
          0, 0, 0, 0, 0,
        ],
        [
          0.0925916721643574, 0, 0, 0, 0.6926148705207836, 0, 0, 0, 0, 0, 0, 0,
          0, 0, 0, 0, 0,
        ],
        [
          0.11081837928332539, 0.024059253397037746, 0.15383340808408982,
          0.13633576924988056, 0.21872048542761588, 0.04301502880076446,
          0.022601116827520307, 0.04301502880076446, 0.04301502880076446,
          0.022601116827520307, 0.04301502880076446, 0.10498583300525563,
          0.01968484368848543, 0.08603005760152892, 0.10498583300525563,
          0.01968484368848543, 0.08603005760152892,
        ],
      ],
    },
    {
      bmr_equation: "ganpule",
      sex: "female",
      expected: [
        [
          14.254014035317727, 0.23621812426182515, 20.916240021442906,
          18.720286347749642, 6.932710319770664, 1.0462129886287626,
          0.29818892846631634, 0.07728123818442427, 1.0462129886287626,
          0.29818892846631634, 0.07728123818442427, 1.1351593193693266,
          0.30766681616817965, 0.1822670711896799, 1.1351593193693266,
          0.30766681616817965, 0.1822670711896799,
        ],
        [
          0.18372520775919735, 0, 0, 0, 3.502444039980889, 0, 0, 0, 0, 0, 0, 0,
          0, 0, 0, 0, 0,
        ],
        [
          0.0925916721643574, 0, 0, 0, 0.6926148705207836, 0, 0, 0, 0, 0, 0, 0,
          0, 0, 0, 0, 0,
        ],
        [
          0.11081837928332539, 0.024059253397037746, 0.15383340808408982,
          0.13633576924988056, 0.21872048542761588, 0.04301502880076446,
          0.022601116827520307, 0.04301502880076446, 0.04301502880076446,
          0.022601116827520307, 0.04301502880076446, 0.10498583300525563,
          0.01968484368848543, 0.08603005760152892, 0.10498583300525563,
          0.01968484368848543, 0.08603005760152892,
        ],
      ],
    },
  ])(
    "returns correct value when sex is $sex and bmr_equation is $bmr_equation",
    ({ sex, bmr_equation, expected }) => {
      const result = local_mbase(1.72, 74.43, 20, sex, bmr_equation);
      expect(result.map((r) => r.toArray())).toStrictEqual(expected);
    },
  );
});
